# AMI作成とコピー構成

このTerraform構成は、EC2インスタンスからAMIを作成し、別リージョンにコピーする仕組みを提供します。また、AMI作成を自動化するLambda関数も含まれています。

## リソース構成

### ネットワークリソース
- CIDRブロック10.0.0.0/16のVPC
- パブリックサブネット（10.0.0.0/24）
- インターネットゲートウェイ
- インターネットゲートウェイへのルートを持つルートテーブル
- EC2インスタンス用のセキュリティグループ（SSH接続許可）

### コンピューティングリソース
- EC2インスタンス：
  - 指定されたAMIから作成
  - SSM管理用のIAMインスタンスプロファイル
  - キーペアによるSSHアクセス
  - カスタマイズ可能なルートボリュームサイズ

### AMI管理リソース
- AMI作成：
  - EC2インスタンスからのAMI作成（aws_ami_from_instance）
  - 作成されたAMIの大阪リージョンへのコピー（aws_ami_copy）
  
### Lambda関数
- CloudFormationスタック経由でデプロイされるLambda関数
- AMI作成プロセスの自動化に使用

### IAM設定
- EC2インスタンス用のIAMロール
- SSM管理に必要な権限を付与
- Lambda実行に必要な権限

## 使用方法

この構成をデプロイするには、メインのREADME.mdに記載されている手順に従ってください。

## 注意事項

- AMIのコピー先は大阪リージョン（ap-northeast-3）に設定されています
- Lambda関数はCloudFormationテンプレート（lambda.yaml）を使用してデプロイされます
- AMI作成には時間がかかる場合があります